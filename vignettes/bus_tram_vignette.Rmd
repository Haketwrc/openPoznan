---
title: "Vignette Title"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

library(tidyverse)
library (stringr)

bt <- openPoznan::tram_bus_stops()
```

# Trams analysis

- na jakich przystankach jest najwięcej tramwajów
- na jakich najmniej
- jakie linie zatrzymują się na największej liczbie przystanków
- jakie na najmniejszej
- jak wygląda rozkład przestrzenny #przy pomocy leafleta nanieś kółka na mapie na podstawie id
- tramwaj nocny
- autobus za tramwaj

```{r}

Number_of_string <- str_count(bt$Stop_Headsigns, ",") + 1

Max_number_of_machines <- max(Number_of_string)

bt_machines <- bt %>%
  separate(Stop_Headsigns, into=paste0("stop",1:Max_number_of_machines))

bt_machines_id <- bt_machines %>%
  select(ID, 4:(Max_number_of_machines+3)) %>%
  gather(stop, line, -ID) %>%
  filter(!is.na(line)) 

#max tram number in town 







#Max stops for 1 machine
  
bt_machines_id %>%
  group_by(line) %>%
  count() %>%
  arrange(desc(n))

```


```{r}

# Max number of machines on 1 stop

bt_machines_id %>%
  group_by(ID) %>%
  mutate(line = gsub('T',"0.",line)) %>%
  count() %>%
  arrange(desc(n))

# Max number of tram on 1 stop 

bt_machines_id %>%
  filter(line < 30) %>%
  group_by(ID) %>%
  mutate(line = gsub('T',"0.",line)) %>%
  count() %>%
  arrange(desc(n))

```

```{r}

# Min stops of 1 machine

bt_machines_id %>%
  group_by(line) %>%
  count() %>%
  arrange(n)

# Min stops of 1 tram

a <- bt_machines_id %>%
  group_by(line) %>%
  gsub('T',"0,",line) 
  
  count() %>%
  arrange(n)




```

```{r}


bt_machines_id %>%
  group_by(ID) %>%
  count() %>%
  arrange(n)



```

```{r}

```

# Buses analysis

## Day lines 

```{r}

```

## Night lines

## Out of Poznan
